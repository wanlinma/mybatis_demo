<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.asiainfo.mybatis_demo.mapper.AuthorMapper">
    <insert id="addAuthor" parameterType="com.asiainfo.mybatis_demo.entity.Author" useGeneratedKeys="true">
        insert into tb_author(author_name) values(#{author.authorName})
    </insert>


<!--    一对多查询，某个作者的所有 博客 ，通过某个 作者的 id -->

    <select id="getAllBlogsOfAuthor" resultMap="allAuthorBlog" parameterType="com.asiainfo.mybatis_demo.entity.Author">
        select * from tb_author join tb_blog on tb_author.author_id = tb_blog.author_ref where author_id=#{author.authorId};
    </select>

<!--    也可嵌套查询结果-->
    <resultMap id="allAuthorBlog" type="com.asiainfo.mybatis_demo.entity.Author">
        <id property="authorId" column="author_id"/>
        <result property="authorName" column="author_name"/>
        <collection property="blogs" ofType="com.asiainfo.mybatis_demo.entity.Blog" foreignColumn="authorName">
            <id property="blogId" column="blog_id"/>
            <result property="blogTitle" column="blog_title"/>
        </collection>
    </resultMap>
</mapper>